# ECサイトシステム 基本設計書

| ドキュメントバージョン | 1.0 |
|------------------------|-----|
| 作成日                 | 2025年7月1日 |
| 作成チーム             | チームjobs |
| 承認者                 | 平本さん |
| 更新履歴               | 2025/07/01: Ver.1.0 初版作成 |

---

## 1. はじめに

### 1.1. 本書の目的

本書は、〇〇社が構築する「ECサイトシステム」の基本設計内容を定義するものである。  
要件定義書に基づき、システム構成、主要機能、画面設計、データ構造、操作フロー、非機能対策の設計方針を定め、後続工程（詳細設計・開発・テスト等）における設計指針とすることを目的とする。

### 1.2. プロジェクト概要

本プロジェクトは、〇〇社が提供するこだわりの雑貨（文房具・キッチン用品など）を、より多くの顧客に届けるためのオンライン販売チャネルの確立を目的とするものである。  
従来はSNSによる情報発信に限定され、注文は手作業対応で非効率であったが、ECサイトを構築することで、**販路拡大**・**業務効率化**・**商品訴求力の強化**を図る。

### 1.3. 前提知識
 
本書を読むにあたり、以下の知識を有していることを前提とする。
 
- 本プロジェクトの要件定義書の内容
- Webアプリケーション開発の基本的な知識 (HTTP, HTML, CSS, JavaScript)
- REST API の基本的な概念
- Java および Spring Boot フレームワークの基本的な知識
- リレーショナルデータベースの基本的な知識

---

## 2. システム概要

### 2.1. システムの目的

- オンライン販売チャネルの確立
- 商品魅力の訴求
- 顧客利便性の向上
- 業務効率化

＊詳細は、要件定義書参照

### 2.2. 対象ユーザー

| 区分   | 役割 | 利用内容 |
|--------|------|-----------|
| 顧客   | 商品購入者 | 商品閲覧、カート操作、注文手続き |
| 管理者 | 〇〇社担当者 | 商品管理、注文確認、発送準備など |

### 2.3. システム構成図

<div class="mermaid">
graph LR
    顧客端末[顧客PC/スマホ<br>（Chrome/Safariなど）] -- HTTPS --> ECサーバ[ECサイト Webサーバ]
    管理端末[管理者PC<br>（社内担当者）] -- HTTPS --> ECサーバ
    ECサーバ --> DB[(商品情報DB・注文DB)]
    ECサーバ --> ストレージ[(商品画像等ファイルストレージ)]
    ECサーバ --> メール[(メール通知サーバ)]
    管理端末 --> 認証システム[(Active Directory)] --> ECサーバ
 
    style 顧客端末 fill:#fff8dc,stroke:#333
    style 管理端末 fill:#fff8dc,stroke:#333
    style ECサーバ fill:#cdeeff,stroke:#333,stroke-width:2px
    style DB fill:#e0ffe0,stroke:#333
    style ストレージ fill:#f9f,stroke:#333
    style メール fill:#ffe599,stroke:#333
</div>

### 2.4. 外部インターフェース概要

- **Active Directory**: ユーザー認証のために連携を行う場合がある。（オプション）

- **メール送信機能（SMTP連携）**：注文完了時に、顧客へ自動で確認メールを送信する

## 3. 機能設計

### 3.1. 機能一覧

#### 顧客向け機能

- 商品一覧表示
- 商品詳細表示
- カート操作（追加・編集・削除）
- 注文情報入力
- 注文確定（完了画面／メール通知）

#### 管理者向け機能

- 商品登録・編集・削除
- 注文一覧・詳細確認・ステータス管理
- 簡易在庫確認
- データ連携機能
    - CSVファイルによる備品情報一括登録機能
    - (オプション) 在庫不足通知メール送信機能

### 3.2. 機能構成図

<div class="mermaid">
graph TD

    A[ECサイトシステム] --> B(顧客向け機能)

    A --> C(管理者向け機能)
 
    subgraph B[顧客向け機能]

        B1[商品一覧表示]

        B2[商品詳細表示]

        B3[カート操作]

        B4[注文入力・確定]

    end
 
    subgraph C[管理者向け機能]

        C1[商品登録・編集・削除]

        C2[注文一覧・詳細確認]

        C3[簡易在庫確認]

    end
 
    style A fill:#f9f,stroke:#333,stroke-width:2px
</div>


### 3.3. 業務フロー

#### 顧客購入フロー（概要）

   
  

管理者による注文処理フロー
<div class="mermaid">
sequenceDiagram
管理者->>ECサイトシステム: 管理画面へログイン
ECサイトシステム-->>管理者: 管理メニュー表示

管理者->>ECサイトシステム: 注文管理を選択
ECサイトシステム->>データベース: 注文一覧情報取得
データベース-->>ECサイトシステム: 注文一覧情報返却
ECサイトシステム-->>管理者: 注文一覧画面表示

管理者->>ECサイトシステム: 特定の注文を選択 (詳細表示)
ECサイトシステム->>データベース: 注文詳細情報取得
データベース-->>ECサイトシステム: 注文詳細情報返却
ECサイトシステム-->>管理者: 注文詳細画面表示

管理者->>ECサイトシステム: 注文ステータスを更新 (例: 「注文受付」→「発送準備中」)
ECサイトシステム->>データベース: 注文ステータスを更新
データベース-->>ECサイトシステム: 更新完了
ECサイトシステム-->>管理者: 更新完了メッセージ表示
管理者->>管理者: (システム外) 商品梱包・発送手配
管理者->>ECサイトシステム: 注文ステータスを「発送済み」に更新
ECサイトシステム->>データベース: 注文ステータスを更新
データベース-->>ECサイトシステム: 更新完了
ECサイトシステム-->>管理者: 更新完了メッセージ表示
</div>


#### 管理者業務フロー（概要）


管理者による在庫管理フロー
ECサイトシステムにおける管理者の在庫管理は、現時点では簡易在庫数（登録時の数値）の表示と更新に限定される。複雑な入出庫管理や自動発注などの機能はスコープ外であるため、その前提でのフローとなる。

1. 管理者による商品情報登録・更新フロー
<div class="mermaid">
sequenceDiagram
    participant 管理者
    participant ECサイトシステム
    participant データベース

    管理者->>ECサイトシステム: 管理画面へログイン
    ECサイトシステム-->>管理者: 管理メニュー表示

    管理者->>ECサイトシステム: 商品管理を選択
    ECサイトシステム->>データベース: 商品一覧情報取得
    データベース-->>ECサイトシステム: 商品一覧情報返却
    ECサイトシステム-->>管理者: 商品管理一覧画面表示

    管理者->>ECサイトシステム: 商品の新規登録または編集を選択
    ECサイトシステム-->>管理者: 商品登録・編集画面表示

    管理者->>ECサイトシステム: 商品情報（商品名、価格、**在庫数**など）を入力/変更し、保存
    ECサイトシステム->>データベース: 商品テーブル (ITEMS) の情報を更新/登録
    データベース-->>ECサイトシステム: 更新/登録完了
    ECサイトシステム-->>管理者: 更新/登録完了メッセージ表示
    管理者->>管理者: (必要に応じて) サイト上の商品表示を確認
</div>

---

## 4. 画面設計

### 4.1. 画面一覧

#### 顧客側
- トップページ
- ログイン画面
- 会員登録画面
- 商品一覧画面
- 商品詳細画面
- カート画面
- 注文確認画面
- 注文完了画面
- 注文情報入力画面

#### 管理者側
- 管理ログイン画面	
- 商品管理画面	
- 商品登録／編集画面	
- 注文管理画面	
- 注文詳細画面

### 4.2. 画面遷移図


#### 顧客側



<div class="mermaid">
graph TD
    
     A[トップページ] -->|会員登録の意思| I[会員登録画面]
    I[会員登録画面]-->|会員登録|B[ログイン画面]
    A[トップページ] -->|ログイン| B[ログイン画面]
    A -->|商品検索| C[商品一覧画面]
    A -->|カート選択| D[カート画面]
    B -->|トップに戻る| A
    C -->|商品選択| E[商品詳細画面]
    E -->|カート選択| D
    D -->|注文手続き| F[注文情報入力画面]
    F -->|注文確認| G[注文確認画面]
    G -->|注文確定| H[注文完了画面]
    H -->|ホームに戻る| A
</div>

#### 管理者側

<div class="mermaid">
graph TD
    管理ログイン画面 -->|ログイン| 商品管理画面
    商品管理画面 -->|商品追加 編集| 商品登録編集画面
    商品管理画面 -->|注文管理選択| 注文管理画面
    注文管理画面 -->|注文選択| 注文詳細画面
</div>



### 4.3. UI/UX基本方針

- **シンプルさ**: 直感的に操作できるよう、画面構成や操作手順はシンプルにデザイン。ターゲット層（丁寧な暮らしに関心がある層）に響く、洗練されたデザインを目指す。
- **一貫性**: ボタンの配置、ラベルの命名規則、エラーメッセージの表示形式などをシステム全体で統一する。
- **視認性**: 文字サイズや色使いに配慮し、情報が読みやすく、特に商品写真が映えるような白を基調とした清潔感のあるデザインとする。
- **効率性**: 主要な操作（商品検索、購入手続き）は、少ない手数で完了できるように購入導線の最適化を目指す。
- **フィードバック**: ユーザーの操作に対して、処理中であることや処理結果（成功、エラー）を明確に表示する。
- **モバイルファースト**: スマートフォンからの利用が多いため、スマートフォンでの表示や操作に最適化されたレスポンシブデザインを実装。画面サイズに応じてレイアウトが自動調整され、どのデバイスからでも快適に利用できるように作成。

### 4.4. ワイヤーフレーム（例）

#### 4.4.1. 商品一覧画面（GC0201）
+----------------------------------------------------------+
| ヘッダー（ロゴ） | [ カテゴリ選択 ▼ ]  [ カート 🛒 ]       |
+----------------------------------------------------------+
| 【カテゴリ名】                                          |
| -------------------------------------------------------- |
| [商品画像]  商品名         価格（税込） [詳細を見る]     |
| [商品画像]  商品名         価格（税込） [詳細を見る]     |
| ...                                                      |
+----------------------------------------------------------+
| フッター（会社情報・プライバシーポリシー等）             |
+----------------------------------------------------------+


#### 4.4.2. 注文入力画面（GC0401）
+----------------------------------------------------------+
| ヘッダー（ロゴ）                                         |
+----------------------------------------------------------+
| ■ ご注文情報入力                                        |
| 氏名： [                   ]                             |
| 住所： [                   ]                             |
| 電話番号： [              ]                              |
| メールアドレス： [         ]                             |
| -------------------------------------------------------- |
| [注文を確定する]   [カートに戻る]                        |
+----------------------------------------------------------+




### 4.5. 画面項目定義（例）

**注文情報入力画面**

| 項目名     | 型       | 備考                   |
|------------|----------|------------------------|
| 氏名       | テキスト | 必須、最大50文字       |
| 住所       | テキスト | 必須、最大100文字      |
| 電話番号   | テキスト | ハイフン可、15文字まで |
| メールアドレス | テキスト | メール形式            |

---

## 5. データ設計

### 5.1. ER図
<div class="mermaid">
erDiagram
    CUSTOMER ||--o{ ORDER : places
    ORDER ||--|{ ORDER_ITEM : contains
    PRODUCT }o--|| CATEGORY : categorized
    ADMIN_USER }o--|| ROLE : assigned
    ADMIN_USER ||--o{ PRODUCT : manages
    ORDER }o--|| ORDER_STATUS : has
 
    CUSTOMER {
        string customer_id PK
        string name
        string email
        string address
        string phone
        datetime created_at
    }
 
    PRODUCT {
        string product_id PK
        string name
        string description
        int price
        string material
        string image_path
        string category_id FK
        datetime created_at
        datetime updated_at
    }
 
    CATEGORY {
        string category_id PK
        string name
    }
 
    ORDER {
        string order_id PK
        string customer_id FK
        string status_id FK
        datetime order_date
    }
 
    ORDER_ITEM {
        string order_id FK
        string product_id FK
        int quantity
        int unit_price
    }
 
    ADMIN_USER {
        string admin_id PK
        string name
        string email
        string password_hash
        string role_id FK
    }
 
    ROLE {
        string role_id PK
        string role_name
    }
 
    ORDER_STATUS {
        string status_id PK
        string status_name
    }
</div>

### 5.2. テーブル定義（抜粋）

- `CUSTOMER`: 顧客情報
- `PRODUCT`: 商品情報
- `CATEGORY`: 商品カテゴリ
- `ORDER`: 注文
- `ORDER_ITEM`: 注文明細
- `ADMIN_USER`: 管理者
- `ROLE`: ロール
- `ORDER_STATUS`: 注文ステータス

---

## 6. 非機能要件 対応方針

### 6.1. 性能

本システムでは、以下の性能基準を目標とする。

- **画面応答時間**：商品一覧表示、商品詳細表示、カート表示、注文完了といった主要画面における処理応答時間は、通常時で **2秒以内** を目標とする。
- **同時接続数**：初期段階では想定同時アクセス数を **100〜200件程度** とし、この範囲内で安定したサービス提供が可能な構成とする。
- **拡張性配慮**：今後のアクセス数増加に備え、アプリケーションおよびデータベースのスケーラビリティを意識した構成とする。


### 6.2. セキュリティ

顧客の個人情報を取り扱うサービスとして、以下のセキュリティ対策を講じる。

- **通信の暗号化**：すべてのWeb通信は HTTPS（TLS 1.2以上） により暗号化し、盗聴・改ざんを防止する。
- **入力値検証**：SQLインジェクションやクロスサイトスクリプティング（XSS）など、入力値に関する脆弱性を防止するためのサーバーサイド検証を実装する。
- **個人情報保護法の遵守**：顧客情報や注文履歴などの個人情報は、適切な範囲で収集・利用・保管し、法令に従って管理する。
- **SMTP認証情報の管理**：外部メール送信に必要なSMTPの認証情報は、環境変数等で安全に管理し、ハードコードを避ける。


### 6.3. 可用性

- **サービス稼働時間**：原則として、ECサイトは **24時間365日利用可能** なシステムとして設計する。
- **障害時対応**：データベースのバックアップは **日次で自動取得** し、障害発生時に復旧可能な設計とする。アプリケーションログにより障害調査が行えるよう、必要なログを出力する。
- **クラウド基盤の活用**：クラウドインフラ上でシステムを構築し、インフラ障害に対する柔軟な復旧やスケーリングが可能な構成とする。


### 6.4. その他（保守性・拡張性）

- **モジュール設計の採用**：将来的な機能追加（例：クレジット決済、レビュー投稿、会員機能など）を容易にするため、画面・機能単位で疎結合なモジュール設計とする。
- **管理画面のGUI化**：非エンジニアでも運用できるよう、管理者向け商品管理・注文管理機能はGUIで実装する。
- **ログと監査記録**：重要な操作（注文確定、商品更新など）については操作ログを残し、トラブル時の調査や内部統制に備える。
- **レスポンシブ対応**：スマートフォンやタブレット端末でも快適に閲覧・操作できるよう、レスポンシブWebデザインを採用する。

---

## 7. 運用・保守設計
本章では、システム稼働後の運用および保守に関する設計方針を示す。安定稼働を維持し、将来的な拡張やトラブル対応を円滑に行うことを目的とする。

### 7.1 管理者向け運用設計

- **管理画面提供**  
  商品管理および注文管理をWeb上のGUIにて提供する。非技術者でも直感的に操作できるインターフェースを設計する。

- **運用マニュアル**  
  管理者向けに以下の運用マニュアルを整備予定：
  - 商品登録・編集手順書
  - 注文内容確認・発送対応手順
  - カテゴリ追加・商品写真アップロード方法
  - 障害発生時の初期対応手順（例：画面エラー時の問い合わせルート）

- **権限管理**  
  管理者用アカウントは1社内担当者あたり1IDを原則とし、ログインID・パスワードは厳格に管理する。

### 7.2 障害監視・ログ設計

- **ログ出力内容**  
  以下の種類のログをサーバーに出力する。
  - **アクセスログ**（URL、IP、ステータスコード）
  - **エラーログ**（例外・エラー内容、タイムスタンプ、ユーザー情報）
  - **操作ログ**（注文確定、商品編集など重要操作の履歴）

- **ログ保管方針**  
  ログは最大6ヶ月分を保管対象とし、古いログは自動的にローテートまたはアーカイブされる。

- **監視対応**（将来拡張想定）  
  クラウドインフラにおける死活監視（HTTP監視、CPU/メモリ利用率）を導入可能な設計とする。アラート通知はメールやチャット連携を想定。

### 7.3 バックアップ・リカバリ設計

- **対象範囲**  
  バックアップ対象は以下とする：
  - データベース（顧客情報、注文履歴、商品情報）
  - 商品画像等アップロードファイル（該当する場合）

- **方式と頻度**  
  - DB：日次でフルバックアップを取得、3世代を保持
  - ファイル：1日1回スナップショットを取得（クラウドストレージ利用時）

- **保存先**  
  本番環境とは別リージョン／別インスタンスへの保管を基本とし、障害発生時でも速やかな復旧が可能な構成とする。

- **復旧手順**  
  バックアップからのリストア手順をドキュメント化し、定期的にテスト復旧を行う。

### 7.4 ソフトウェア・ライブラリ保守

- **依存パッケージ管理**  
  使用するOSSライブラリや外部パッケージについては、脆弱性情報を定期的にチェックし、必要に応じてアップデートを行う。

- **メンテナンス期間**  
  リリース後最低1年間は、軽微な修正および不具合対応を保守範囲とする（別途契約条件による）。

### 7.5 拡張・改修への配慮

- **モジュール設計**  
  商品レビュー機能

---

## 8. 制約事項・前提条件

本章では、システムの設計・実装にあたり前提とする条件および技術的・業務的な制約事項を明示する。

### 8.1 技術的制約

- **対応ブラウザ**：以下の最新版を公式サポート対象とする
  - Google Chrome
  - Microsoft Edge
  - Safari（iOS端末向け）

- **対応デバイス**：
  - PC（Windows / macOS）
  - スマートフォン（iOS / Android）
  - ※ ネイティブアプリは対象外（Webブラウザ利用前提）

- **インフラ構成**：
  - クラウド環境上に構築（具体的なサービスは要件定義に基づき選定）
  - インターネット接続前提、社内LAN向けではない

### 8.2 運用ルール・組織的制約

- **商品登録作業**：
  - サイト稼働開始までに〇〇社側で販売商品情報をすべて登録するものとする

- **管理者教育**：
  - システム管理者に対する初期操作説明会を1回実施（以降はマニュアル対応）

- **運用体制**：
  - システムの運用（商品追加、注文確認など）は〇〇社担当者にて実施


### 8.3 予算・納期制約

- **開発予算**：上限 ○○○万円（税別）  
- **リリース時期**：2025年7月末までの本番公開を目指す  
  - ※ テスト・デザインレビュー含む納期スケジュールは別途定義

### 8.4 法令・コンプライアンス対応

- **準拠法規**：
  - 個人情報保護法（顧客情報取り扱い）
  - 特定商取引法（EC取引表示義務）
  - 電子契約法（確認画面設置など）

- **データの国外移転**：
  - サーバーが国内外にまたがる場合は、データ保護規制に従うこと

### 8.5 対象外事項（本プロジェクト範囲外）

以下の機能・連携は初期リリースにおいて開発対象外とする（別途フェーズで検討可能）：

- クレジットカード決済連携
- 会員ログイン・会員登録機能（任意対応）
- 商品レビュー・評価機能
- 高度な在庫管理（自動補充提案など）
- 会計システム・仕入先システム連携
- 多言語対応
- スマホ専用ネイティブアプリ開発（Webアプリのみ対象）

### 8.6 その他前提条件

- 顧客情報、商品情報などの初期データは、〇〇社からCSV形式等で提供されるものとする
- 商品写真などのメディアファイルは、指定フォルダへのアップロード方式で管理
- クライアント端末は常時インターネット接続されていることを前提とする


---

## 9. 用語集・参考情報

| 用語 | 説明 |
|------|------|
| ECサイト | オンライン販売機能を持つWebサイト |
| カート機能 | 一時的に商品を保持し購入する仕組み |
| SSL/TLS | 通信暗号化プロトコル |
| XSS | クロスサイトスクリプティング攻撃 |
| SQLインジェクション | 不正SQL命令による攻撃 |

---

## 10. 承認欄

| 承認者氏名   | 所属・役職                   | 日付           | 印 |
|--------------|------------------------------|----------------|----|
| 〇〇 〇〇（甲） | 株式会社〇〇 事業企画部 部長 | 2025年MM月DD日 |    |
| △△ △△（乙） | 開発会社 プロジェクトマネージャー | 2025年MM月DD日 |    |
| □□ □□（乙） | 開発会社 システムエンジニア     | 2025年MM月DD日 |    |
